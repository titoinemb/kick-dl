"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const playwright_1=require("playwright");exports.default=async t=>{if(!t||""===t.trim())return"Invalid URL";const e=t.match(/kick\.com\/([^\/]+)\/videos\/([a-f0-9-]+)/);if(!e)return"Invalid URL";const a=e[1],i=e[2],o=await playwright_1.chromium.launch({args:["--no-sandbox","--disable-setuid-sandbox","--disable-infobars","--disable-extensions","--disable-popup-blocking","--window-size=1920,1080"]}),s=await o.newContext({userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",viewport:{width:1920,height:1080},acceptDownloads:!1,baseURL:"https://kick.com"});await s.setDefaultTimeout(18e4);const n=await s.newPage();await n.goto(`https://kick.com/api/v1/channels/${a}`),await n.waitForLoadState("networkidle");let r,c;((await n.evaluate(async t=>(await fetch(`https://kick.com/api/v1/channels/${t}`)).json(),a)).previous_livestreams||[]).forEach(t=>{t.video?.uuid===i&&([r,c]=[t.video,t])}),await n.goto(`https://kick.com/api/v1/video/${i}`),await n.waitForLoadState("networkidle");const l=await n.evaluate(async t=>(await fetch(`https://kick.com/api/v1/video/${t}`)).json(),i);r||(r=l);const d=(c?.thumbnail?.src||r.thumbnail?.src||r.thumbnail?.url).match(/video_thumbnails\/([^\/]+)\/([^\/]+)\//);if(!d)return"Thumbnail ID extraction failed";const u=d[1],h=d[2],w=new Date(c?.created_at||c?.start_time||r.created_at||r.start_time),m=[w.getFullYear(),w.getMonth()+1,w.getDate(),w.getHours(),w.getMinutes()].join("/");return await o.close(),{file:`https://stream.kick.com/ivs/v1/196233775518/${u}/${m}/${h}/media/hls/master.m3u8`,name:l.livestream.session_title}};